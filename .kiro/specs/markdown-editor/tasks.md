# マークダウンエディタ タスク書

**プロジェクト**: マークダウンエディタ  
**作成日**: 2025-09-20  
**ステータス**: ドラフト  
**フェーズ**: Tasks  
**前提**: 要件書・設計書レビュー完了

## 1. タスク概要

### 1.1 実装フェーズ構成
- **Phase 1**: MVP実装（基本機能）- 1週間
- **Phase 2**: 品質向上（最適化・テスト）- 1週間  
- **Phase 3**: 拡張機能（UX改善）- 1週間

### 1.2 完了基準
- [ ] 全てのMustHaveタスクが完了している
- [ ] TypeScript/Lintエラーが0件
- [ ] テストカバレッジが80%以上
- [ ] 要件書の受入基準を満たしている

---

## 2. Phase 1: MVP実装（基本機能）

### 2.1 プロジェクトセットアップ

#### TASK-001: 開発環境構築
- **優先度**: Critical
- **工数**: 0.5日
- **担当**: 開発者
- **説明**: プロジェクトの基本構造とツール設定

**実装内容**:
- [ ] `package.json`の依存関係設定
  - [ ] Next.js 15.3.3
  - [ ] TypeScript設定
  - [ ] marked（マークダウンパーサー）
  - [ ] Prism.js（シンタックスハイライト）
- [ ] `tsconfig.json`設定
- [ ] Biome設定（`.biome.json`）
- [ ] Vitest設定（`vitest.config.ts`）
- [ ] `.gitignore`設定

**受入基準**:
- [ ] `npm run dev`でNext.jsが起動する
- [ ] `npm run build`でビルドが成功する
- [ ] `npm run lint`でLintが実行される
- [ ] `npm run test`でテストが実行される

---

#### TASK-002: フォルダ構造作成
- **優先度**: Critical
- **工数**: 0.5日
- **担当**: 開発者
- **説明**: 設計書に基づくフォルダ構造の作成

**実装内容**:
- [ ] `src/app/`ディレクトリ作成
- [ ] `src/features/markdown-editor/`構造作成
- [ ] `src/components/`ディレクトリ作成
- [ ] `src/lib/`ディレクトリ作成
- [ ] 各フォルダに`index.ts`作成

**受入基準**:
- [ ] 設計書通りのフォルダ構造が作成されている
- [ ] 各フォルダのindex.tsが正しくエクスポートしている

---

### 2.2 コアコンポーネント実装

#### TASK-003: マークダウンパーサー実装
- **優先度**: Critical
- **工数**: 1日
- **担当**: 開発者
- **説明**: markedを使用したマークダウン→HTML変換機能

**実装内容**:
- [ ] `src/features/markdown-editor/lib/parser.ts`実装
  - [ ] marked設定（GFM有効化）
  - [ ] セキュリティ設定（サニタイゼーション）
  - [ ] カスタムレンダラー設定
- [ ] `src/features/markdown-editor/utils/markdown.ts`実装
  - [ ] `parseMarkdown()`関数
  - [ ] `sanitizeHtml()`関数
- [ ] 単体テスト作成

**受入基準**:
- [ ] 基本的なマークダウン記法（見出し、段落、リスト、強調）が変換される
- [ ] GFM（テーブル、strikethrough）が変換される
- [ ] XSS攻撃となるスクリプトタグがサニタイズされる
- [ ] テストカバレッジ90%以上

---

#### TASK-004: MarkdownInput コンポーネント
- **優先度**: Critical
- **工数**: 1日
- **担当**: 開発者
- **説明**: マークダウンテキスト入力用コンポーネント

**実装内容**:
- [ ] `src/features/markdown-editor/presentational/MarkdownInput/index.tsx`
- [ ] `MarkdownInput.module.css`（スタイリング）
- [ ] TypeScript型定義
- [ ] デバウンス処理実装
- [ ] テスト作成

**API仕様**:
```typescript
interface MarkdownInputProps {
  value: string;
  onChange: (value: string) => void;
  onScroll?: (scrollTop: number, scrollHeight: number) => void;
  className?: string;
  placeholder?: string;
  disabled?: boolean;
}
```

**受入基準**:
- [ ] テキストエリアでマークダウンを入力できる
- [ ] 入力時にonChangeが発火する
- [ ] デバウンス処理（300ms）が機能する
- [ ] 10,000文字の大きなテキストでも快適に動作する
- [ ] スクロールイベントが正しく発火する

---

#### TASK-005: MarkdownPreview コンポーネント
- **優先度**: Critical
- **工数**: 1日
- **担当**: 開発者
- **説明**: マークダウンプレビュー表示用コンポーネント

**実装内容**:
- [ ] `src/features/markdown-editor/presentational/MarkdownPreview/index.tsx`
- [ ] `MarkdownPreview.module.css`（プレビュースタイリング）
- [ ] TypeScript型定義
- [ ] HTMLサニタイゼーション
- [ ] テスト作成

**API仕様**:
```typescript
interface MarkdownPreviewProps {
  markdown: string;
  onScroll?: (scrollTop: number, scrollHeight: number) => void;
  scrollTop?: number;
  className?: string;
}
```

**受入基準**:
- [ ] マークダウンテキストがHTMLでプレビューされる
- [ ] GitHubスタイルのマークダウンレンダリング
- [ ] XSSが発生しない（スクリプトタグが無効化）
- [ ] リンクが正しく動作する
- [ ] テーブルが適切に表示される

---

#### TASK-006: useMarkdownEditor フック
- **優先度**: Critical
- **工数**: 1日
- **担当**: 開発者
- **説明**: マークダウンエディタの状態管理フック

**実装内容**:
- [ ] `src/features/markdown-editor/containers/MarkdownEditorContainer/useMarkdownEditor.ts`
- [ ] 状態管理（useState）
- [ ] パフォーマンス最適化（useMemo, useCallback）
- [ ] テスト作成

**API仕様**:
```typescript
interface UseMarkdownEditorReturn {
  markdown: string;
  htmlContent: string;
  isPreviewMode: boolean;
  setMarkdown: (value: string) => void;
  togglePreviewMode: () => void;
  isProcessing: boolean;
}
```

**受入基準**:
- [ ] マークダウンテキストの状態管理が動作する
- [ ] HTMLコンテンツが自動生成される
- [ ] プレビューモード切り替えが動作する
- [ ] パフォーマンス最適化が実装されている

---

#### TASK-007: MarkdownEditorContainer コンポーネント
- **優先度**: Critical
- **工数**: 1日
- **担当**: 開発者
- **説明**: Input・Previewコンポーネントを統合するコンテナ

**実装内容**:
- [ ] `src/features/markdown-editor/containers/MarkdownEditorContainer/index.tsx`
- [ ] useMarkdownEditorフックの統合
- [ ] 子コンポーネントのprops管理
- [ ] テスト作成

**受入基準**:
- [ ] MarkdownInputとMarkdownPreviewが連携する
- [ ] リアルタイムプレビューが動作する
- [ ] エラー処理が適切に実装されている

---

### 2.3 レイアウト・ページ実装

#### TASK-008: ２カラムレイアウト実装
- **優先度**: Critical
- **工数**: 1日
- **担当**: 開発者
- **説明**: デスクトップ用２カラムレイアウト

**実装内容**:
- [ ] `src/features/markdown-editor/presentational/MarkdownEditor/index.tsx`
- [ ] `MarkdownEditor.module.css`（レイアウトスタイル）
- [ ] CSS Grid/Flexboxによる２カラム実装
- [ ] テスト作成

**受入基準**:
- [ ] 画面が左右２つのカラムに分割される
- [ ] 左側：入力エリア（50%）、右側：プレビューエリア（50%）
- [ ] カラム間にリサイズ機能なし（シンプル実装）
- [ ] 高さが画面に合わせて調整される

---

#### TASK-009: メインページ実装
- **優先度**: Critical
- **工数**: 0.5日
- **担当**: 開発者
- **説明**: ルートパス（/）のメインページ

**実装内容**:
- [ ] `src/app/page.tsx`実装
- [ ] MarkdownEditorContainerの統合
- [ ] メタタグ設定
- [ ] テスト作成

**受入基準**:
- [ ] ルートパス（/）でマークダウンエディタが表示される
- [ ] ページタイトルが適切に設定されている
- [ ] SEO用メタタグが設定されている

---

#### TASK-010: グローバルレイアウト実装
- **優先度**: High
- **工数**: 0.5日
- **担当**: 開発者
- **説明**: アプリ全体のレイアウト設定

**実装内容**:
- [ ] `src/app/layout.tsx`実装
- [ ] `src/app/globals.css`実装
- [ ] レスポンシブ基本設定
- [ ] フォント設定

**受入基準**:
- [ ] 基本的なレスポンシブ対応
- [ ] 適切なフォント（モノスペース等）設定
- [ ] CSS変数による一貫したデザイン

---

### 2.4 Phase 1 統合・テスト

#### TASK-011: Phase 1 統合テスト
- **優先度**: High
- **工数**: 1日
- **担当**: 開発者
- **説明**: Phase 1機能の統合確認

**実装内容**:
- [ ] 結合テスト作成
- [ ] E2E基本テスト作成
- [ ] パフォーマンステスト（基本）
- [ ] ブラウザ動作確認

**受入基準**:
- [ ] マークダウン入力→プレビュー表示の完全なフローが動作
- [ ] 基本的なGFM記法が正しく変換される
- [ ] TypeScript/Lintエラーが0件
- [ ] 10,000文字のドキュメントが快適に動作

---

## 3. Phase 2: 品質向上（最適化・テスト）

### 3.1 レスポンシブ対応

#### TASK-012: モバイル対応実装
- **優先度**: High
- **工数**: 1.5日
- **担当**: 開発者
- **説明**: モバイル・タブレット向けレスポンシブ対応

**実装内容**:
- [ ] モバイル用レイアウト（単一カラム）
- [ ] 入力・プレビュー切り替え機能
- [ ] タッチ操作対応
- [ ] ビューポート設定

**ブレークポイント**:
- デスクトップ: 1200px以上
- タブレット: 768px〜1199px
- モバイル: 767px以下

**受入基準**:
- [ ] モバイル（767px以下）で単一カラムレイアウト
- [ ] 入力・プレビューの切り替えボタンが動作
- [ ] タッチスクロールが快適
- [ ] フォントサイズがモバイルに適している

---

#### TASK-013: アクセシビリティ実装
- **優先度**: Medium
- **工数**: 1日
- **担当**: 開発者
- **説明**: WCAG 2.1 AA基準の基本的なアクセシビリティ対応

**実装内容**:
- [ ] キーボードナビゲーション対応
- [ ] ARIAラベル実装
- [ ] コントラスト比改善
- [ ] スクリーンリーダー対応

**受入基準**:
- [ ] Tab/Shift+Tabでフォーカス移動
- [ ] すべてのインタラクティブ要素にARIAラベル
- [ ] コントラスト比4.5:1以上
- [ ] スクリーンリーダーで内容が読み上げられる

---

### 3.2 パフォーマンス最適化

#### TASK-014: レンダリング最適化
- **優先度**: High
- **工数**: 1日
- **担当**: 開発者
- **説明**: レンダリングパフォーマンスの改善

**実装内容**:
- [ ] デバウンス最適化（300ms → 適切な値）
- [ ] useMemoによるHTML変換キャッシュ
- [ ] useCallbackによるイベントハンドラー最適化
- [ ] React.memoによるコンポーネント最適化

**受入基準**:
- [ ] マークダウン変換時間が100ms以下
- [ ] 大きなドキュメント（10,000文字）で快適な入力
- [ ] メモリリークが発生しない

---

#### TASK-015: バンドルサイズ最適化
- **優先度**: Medium
- **工数**: 0.5日
- **担当**: 開発者
- **説明**: 初期ロードサイズの最適化

**実装内容**:
- [ ] Tree shakingの設定
- [ ] Dynamic importの実装（Prism.js等）
- [ ] Next.jsビルド最適化設定
- [ ] バンドル分析

**受入基準**:
- [ ] 初期バンドルサイズが1MB以下
- [ ] ページロード時間が2秒以下
- [ ] 未使用コードが含まれていない

---

### 3.3 エラーハンドリング

#### TASK-016: エラーバウンダリ実装
- **優先度**: High
- **工数**: 1日
- **担当**: 開発者
- **説明**: React Error Boundary実装

**実装内容**:
- [ ] `src/components/presentational/ErrorBoundary/index.tsx`
- [ ] エラー時のフォールバックUI
- [ ] エラーログ記録
- [ ] ユーザーフレンドリーなエラーメッセージ

**受入基準**:
- [ ] JavaScriptエラーでアプリ全体がクラッシュしない
- [ ] エラー時に適切なメッセージが表示される
- [ ] エラー内容がログに記録される

---

#### TASK-017: 入力値検証・制限
- **優先度**: Medium
- **工数**: 0.5日
- **担当**: 開発者
- **説明**: 大量テキスト入力への対応

**実装内容**:
- [ ] 最大文字数制限（50,000文字）
- [ ] 警告メッセージ表示
- [ ] プログレス表示
- [ ] メモリ使用量監視

**受入基準**:
- [ ] 50,000文字制限が適切に動作
- [ ] 制限近くで警告が表示される
- [ ] メモリ不足時に適切に処理される

---

### 3.4 テスト強化

#### TASK-018: ユニットテスト完成
- **優先度**: High
- **工数**: 2日
- **担当**: 開発者
- **説明**: 全コンポーネントのユニットテスト

**テスト対象**:
- [ ] markdownパーサー関数
- [ ] useMarkdownEditorフック
- [ ] 各プレゼンテーショナルコンポーネント
- [ ] ユーティリティ関数

**受入基準**:
- [ ] テストカバレッジ80%以上
- [ ] 境界値テストが含まれている
- [ ] モックが適切に使用されている

---

#### TASK-019: 統合テスト実装
- **優先度**: Medium
- **工数**: 1日
- **担当**: 開発者
- **説明**: コンポーネント間連携テスト

**テスト内容**:
- [ ] 入力→プレビュー連携テスト
- [ ] レスポンシブ動作テスト
- [ ] エラーハンドリングテスト

**受入基準**:
- [ ] ユーザーフローのテストが網羅されている
- [ ] 異常系テストが含まれている

---

## 4. Phase 3: 拡張機能（UX改善）

### 4.1 シンタックスハイライト

#### TASK-020: コードブロックハイライト実装
- **優先度**: Medium
- **工数**: 1.5日
- **担当**: 開発者
- **説明**: プレビュー用コードブロックシンタックスハイライト

**実装内容**:
- [ ] Prism.js統合
- [ ] 主要言語サポート（JS/TS/Python/Java/C++/HTML/CSS）
- [ ] ダイナミックインポート
- [ ] テーマ設定

**受入基準**:
- [ ] コードブロックが適切にハイライトされる
- [ ] 言語指定が正しく認識される
- [ ] 未対応言語でもエラーが発生しない

---

#### TASK-021: 入力エリアハイライト実装
- **優先度**: Low
- **工数**: 2日
- **担当**: 開発者
- **説明**: 入力エリアでのマークダウン記法ハイライト

**実装内容**:
- [ ] CodeMirrorまたは自作ハイライト実装
- [ ] 見出し、強調、リンク等の色分け
- [ ] パフォーマンス最適化

**受入基準**:
- [ ] 基本的なマークダウン記法がハイライトされる
- [ ] 入力パフォーマンスが劣化しない

---

### 4.2 スクロール同期

#### TASK-022: スクロール同期機能実装
- **優先度**: Low
- **工数**: 2日
- **担当**: 開発者
- **説明**: 入力エリアとプレビューエリアのスクロール同期

**実装内容**:
- [ ] `src/features/markdown-editor/hooks/useScrollSync.ts`
- [ ] スクロール位置計算アルゴリズム
- [ ] 同期有効/無効切り替え
- [ ] スムーズスクロール

**受入基準**:
- [ ] 入力エリアのスクロールでプレビューが連動
- [ ] プレビューエリアのスクロールで入力エリアが連動
- [ ] 同期ON/OFF切り替えが動作
- [ ] 大きなドキュメントでも快適

---

### 4.3 UX改善

#### TASK-023: ローディング・フィードバック
- **優先度**: Medium
- **工数**: 1日
- **担当**: 開発者
- **説明**: ユーザーフィードバック改善

**実装内容**:
- [ ] ローディングスピナー
- [ ] 変換処理中表示
- [ ] 文字数カウンター
- [ ] ツールチップ

**受入基準**:
- [ ] 重い処理中にローディング表示
- [ ] 現在の文字数・行数が表示される
- [ ] ユーザーが操作状況を理解できる

---

#### TASK-024: キーボードショートカット
- **優先度**: Low
- **工数**: 1日
- **担当**: 開発者
- **説明**: 生産性向上のためのショートカット

**実装内容**:
- [ ] Ctrl+B（太字）、Ctrl+I（斜体）等
- [ ] Ctrl+S（ダウンロード、将来実装用）
- [ ] Ctrl+/（ヘルプ表示）
- [ ] ショートカット一覧表示

**受入基準**:
- [ ] 基本的なショートカットが動作
- [ ] ショートカット一覧が表示される
- [ ] 既存のブラウザショートカットと競合しない

---

### 4.4 最終統合

#### TASK-025: E2Eテスト実装
- **優先度**: High
- **工数**: 2日
- **担当**: 開発者
- **説明**: 全機能のE2Eテスト

**テストシナリオ**:
- [ ] 基本的なマークダウン編集フロー
- [ ] レスポンシブ対応確認
- [ ] パフォーマンステスト
- [ ] クロスブラウザテスト

**受入基準**:
- [ ] メジャーブラウザ（Chrome/Firefox/Safari/Edge）で動作
- [ ] モバイルデバイスで動作
- [ ] 全ユーザージャーニーが完走

---

#### TASK-026: プロダクション準備
- **優先度**: High
- **工数**: 1日
- **担当**: 開発者
- **説明**: 本番環境用設定

**実装内容**:
- [ ] `next.config.js`本番設定
- [ ] CSP（Content Security Policy）設定
- [ ] SEO最適化
- [ ] デプロイメント設定

**受入基準**:
- [ ] `npm run build`が正常に完了
- [ ] 静的エクスポートが正常に動作
- [ ] セキュリティヘッダーが適切に設定

---

## 5. 横断的タスク

### 5.1 ドキュメンテーション

#### TASK-027: README作成
- **優先度**: Medium
- **工数**: 0.5日
- **担当**: 開発者

**内容**:
- [ ] プロジェクト概要
- [ ] セットアップ手順
- [ ] 使用方法
- [ ] 技術スタック
- [ ] ライセンス

---

#### TASK-028: 技術ドキュメント作成
- **優先度**: Low
- **工数**: 0.5日
- **担当**: 開発者

**内容**:
- [ ] アーキテクチャ説明
- [ ] API ドキュメント
- [ ] 開発ガイドライン

---

### 5.2 継続的な作業

#### TASK-029: コードレビュー・リファクタリング
- **優先度**: Medium
- **工数**: 継続
- **担当**: 開発者

**内容**:
- [ ] コード品質チェック
- [ ] パフォーマンス監視
- [ ] 技術的負債の解消

---

## 6. リスクと対策

### 6.1 技術リスク

| リスク | 確率 | 対策 |
|--------|------|------|
| **パフォーマンス問題** | 中 | 早期プロトタイプでの検証、段階的最適化 |
| **ブラウザ互換性** | 低 | 主要ブラウザでの動作確認を各Phase終了時に実施 |
| **セキュリティ脆弱性** | 低 | マークダウンパーサーのサニタイゼーション機能を活用 |
| **レスポンシブ問題** | 中 | モバイルファーストでの設計、早期デバイステスト |

### 6.2 スケジュールリスク

| リスク | 確率 | 対策 |
|--------|------|------|
| **Phase 1遅延** | 低 | シンプルなMVP実装、拡張機能は後回し |
| **テスト工数過大** | 中 | 重要度順にテスト実装、自動化優先 |
| **UI/UX調整時間** | 中 | 基本機能優先、見た目調整は最後 |

---

## 7. 完了基準・受入テスト

### 7.1 機能受入基準

- [ ] **FR-001**: ２カラムレイアウトが正常表示
- [ ] **FR-002**: マークダウン入力が正常動作
- [ ] **FR-003**: リアルタイムプレビューが100ms以下で更新
- [ ] **FR-004**: GFM記法が正しく変換表示
- [ ] **FR-005**: デスクトップ・タブレット・モバイルで適切表示

### 7.2 非機能受入基準

- [ ] **NFR-001**: 10,000文字ドキュメントで快適動作
- [ ] **NFR-003**: Chrome/Firefox/Safari/Edge最新版で動作
- [ ] **NFR-004**: iOS/Android デバイスで正常動作

### 7.3 品質基準

- [ ] TypeScriptエラー: 0件
- [ ] Biome Lintエラー: 0件
- [ ] ユニットテストカバレッジ: 80%以上
- [ ] E2Eテスト全通過
- [ ] バンドルサイズ: 1MB以下
- [ ] 初期ロード時間: 2秒以下

---

## 8. 次のアクション

### 8.1 Phase 1 開始前チェックリスト

- [ ] 要件書・設計書の最終レビュー完了
- [ ] 開発環境の準備完了
- [ ] 必要なツール・ライブラリの調査完了
- [ ] タスクの優先順位と依存関係の確認完了

### 8.2 各Phase完了時チェックリスト

**Phase 1完了時**:
- [ ] 基本機能の動作確認
- [ ] TypeScript/Lintエラー確認
- [ ] Phase 2へ進行可否の判断

**Phase 2完了時**:
- [ ] 品質基準の達成確認
- [ ] テストカバレッジ確認  
- [ ] Phase 3へ進行可否の判断

**Phase 3完了時**:
- [ ] 全機能の最終確認
- [ ] プロダクション準備完了確認
- [ ] リリース準備完了

---

**承認フロー**:
- [ ] タスク分解レビュー完了
- [ ] 工数見積もり承認
- [ ] 実装開始承認

**次のフェーズ**: 実装開始（Phase 1: MVP実装）

---

**作成者**: 開発チーム  
**最終更新**: 2025-09-20  
**バージョン**: 1.0